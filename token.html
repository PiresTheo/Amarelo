<!DOCTYPE html>
<html>
    <head>
        <title>Strava OAuth 2 - Login Page</title>
        <script type="text/javascript" src="jquery/jquery-3.4.1.min.js"></script>
    </head>

    <body>
        <button id="btnToken">Get me Token</button>
        <script type="text/javascript">
            $(document).ready(function(){
                $("#btnToken").click(function() {
                    var qs = new URLSearchParams(window.location.search);
                    var code = qs.get("code");

                    var data = {
                        client_id: "41768",
                        client_secret: "2311a3b45f8ddeff32f72c86ab44dc3da24d317c",
                        code: code,
                        grant_type: "authorization_code"
                    };
                    
                    $.ajax({
                        url: "https://www.strava.com/oauth/token",
                        type: "POST",
                        data: data,
                        success: function(response, textStatus, xhr){
                            console.log(response);
                            console.log(response.access_token);
                        
                            $.ajax({
                                url: "https://www.strava.com/api/v3/athlete/activities?per_page=100",
                                type: "GET",
                                headers : { 
                                    "Accept": "application/json",
                                    "Authorization": "Bearer "+response.access_token},
                                success: function(response2, textStatus2, xhr2){
                                    console.log(response2);

                                    $("#divActivities").html(response2[0].moving_time);
                                    
                                },
                                error: function(error) {
                                    alert(error);
                                    debugger;
                                }
                            })
                        },
                        error: function(error){
                            alert(error);
                            debugger; 
                        }
                    })
                })
            })
        </script>
        <div id="divActivities">
            
        </div>

    </body>

</html>