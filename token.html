<!DOCTYPE html>
<html>
    <head>
        <title>Strava OAuth 2 - Login Page</title>
        <script type="text/javascript" src="jquery/jquery-3.4.1.min.js"></script>
        <link
            rel="stylesheet"
            type="text/css"
            href="bootstrap/css/bootstrap.min.css"
        />
        <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
    </head>

    <body>
        <button id="btnToken">Get me Token</button>
        <script type="text/javascript">
            $(document).ready(function(){
                $("#btnToken").click(function() {
                    //
                    var qs = new URLSearchParams(window.location.search);
                    var code = qs.get("code");
                    var state = qs.get("state");

                    var data = {
                        client_id: "41768",
                        client_secret: "2311a3b45f8ddeff32f72c86ab44dc3da24d317c",
                        state: state,
                        code: code,
                        grant_type: "authorization_code"
                    };
                    //
                    $.ajax({
                        url: "https://www.strava.com/oauth/token",
                        type: "POST",
                        data: data,
                        success: function(response, textStatus, xhr){
                            console.log(response.athlete);
                            console.log(response.access_token);
                            var data2 = {
                                resource: response.athlete,
                                field: response.access_token,
                                code: code
                            }
                            $.ajax({
                                url: "https://www.strava.com/api/v3/athlete/activities",
                                type: "GET",
                                data: data2,
                                success: function(response2, textStatus, xhr){
                                    console.log("wesh");
                                    debugger;
                                },
                                error: function(error){
                                    console.log("ouch");
                                    debugger; 
                                }
                            })
                        },
                        error: function(error){
                            debugger; 
                        }
                    })
                })
            })
        </script>
        
    </body>

</html>